[["index.html", "Assessing interation in epidemiological studies Chapter 1 Definitions 1.1 Effect modification 1.2 Interaction 1.3 Example data 1.4 Further reading", " Assessing interation in epidemiological studies Ehsan Karim, ehsan.karim@ubc.ca, https://ehsank.com/ 2023-02-20 Chapter 1 Definitions 1.1 Effect modification Causal effect of exposure (A) on outcome (Y) depends upon levels of a third factor (B). This is the scenario when the exposure-outcome association differs within the strata of a 2nd exposure (2nd exposure = effect modifier). Interaction term is often added on a logistic regression model to assess the impact. Figure 1.1: An illustration of possible effect modification by a dichotomous factor \\(B\\) (tobacco smoking [smk]) while investigating the impact of a dichotomous factor \\(A\\) (alcohol [alc]) on the dichotomous outcome \\(Y\\) (oral cancer [oc]). 1.2 Interaction Causal effect of combination of multiples exposures (A and B) on outcome (Y). Interaction is the joint causal effect of two exposures on an outcome. Figure 1.2: An illustration of possible interaction by while investigating the impact of two dichotomous factors: \\(A\\) (alcohol [alc]) and \\(B\\) (tobacco smoking [smk]) on the dichotomous outcome \\(Y\\) (oral cancer [oc]). 1.3 Example data Data source: K. Rothman and Keller (1972) require(interactionR) data(OCdata) dim(OCdata) ## [1] 458 3 summary(OCdata) ## oc alc smk ## Min. :0.0000 Min. :0.000 Min. :0.0000 ## 1st Qu.:0.0000 1st Qu.:1.000 1st Qu.:1.0000 ## Median :1.0000 Median :1.000 Median :1.0000 ## Mean :0.5284 Mean :0.893 Mean :0.9105 ## 3rd Qu.:1.0000 3rd Qu.:1.000 3rd Qu.:1.0000 ## Max. :1.0000 Max. :1.000 Max. :1.0000 Variables oc, oral cancer, outcome (Y) alc, alcohol use, first exposure (A) smk, smoking, second exposure (B) outcome = &quot;oc&quot; ex = &quot;alc&quot; dataset = OCdata M &lt;- table(dataset[[ex]], dataset[[outcome]]) rownames(M) &lt;- c(&quot;Exposure -&quot;, &quot;Exposure +&quot;) colnames(M) &lt;- c(&quot;Outcome -&quot;, &quot;Outcome +&quot;) M ## ## Outcome - Outcome + ## Exposure - 38 11 ## Exposure + 178 231 1.3.1 Crude risk ratio require(mosaic) relrisk(M, verbose = TRUE) ## ## Odds Ratio ## ## Proportions ## Prop. 1: 0.7755 ## Prop. 2: 0.4352 ## Rel. Risk: 0.5612 ## ## Odds ## Odds 1: 3.455 ## Odds 2: 0.7706 ## Odds Ratio: 0.2231 ## ## 95 percent confidence interval: ## 0.4656 &lt; RR &lt; 0.6764 ## 0.1109 &lt; OR &lt; 0.4487 ## NULL ## [1] 0.561189 1.3.2 Change exposure label if RR &lt;1 This step is not necessary of RR &gt; 1. The following calculattion assumes that exposure and stratification factors are risk factors for the outcome (RR &gt; 1), not protective factors. If protective, estimates of RERI and AP will be invalid, although the estimate of SI is not affected by this condition. M3 &lt;- matrix(c(M[2,2],M[2,1],M[1,2],M[1,1]), nrow = 2, byrow = TRUE) require(epiR) 1.3.3 Get detailed estimates from 2x2 table require(epiR) res &lt;- epi.2by2(dat = M3, method = &quot;cross.sectional&quot;, conf.level = 0.95, units = 1, interpret = FALSE, outcome = &quot;as.columns&quot;) res ## Outcome + Outcome - Total Prevalence * ## Exposed + 231 178 409 0.56 (0.52 to 0.61) ## Exposed - 11 38 49 0.22 (0.12 to 0.37) ## Total 242 216 458 0.53 (0.48 to 0.57) ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Prevalence ratio 2.52 (1.48, 4.26) ## Odds ratio 4.48 (2.23, 9.02) ## Attrib prevalence in the exposed * 0.34 (0.21, 0.47) ## Attrib fraction in the exposed (%) 60.25 (32.65, 76.54) ## Attrib prevalence in the population * 0.30 (0.18, 0.43) ## Attrib fraction in the population (%) 57.51 (29.69, 74.33) ## ------------------------------------------------------------------- ## Uncorrected chi2 test that OR = 1: chi2(1) = 20.335 Pr&gt;chi2 = &lt;0.001 ## Fisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per population unit Check the results yourself p1 &lt;- as.numeric(strsplit(as.character(res$tab$` Prevalence *`), &quot; &quot;)[[1]][1]) p0 &lt;- as.numeric(strsplit(as.character(res$tab$` Prevalence *`), &quot; &quot;)[[2]][1]) RR &lt;- p1/p0 RR ## [1] 2.545455 RD &lt;- p1 - p0 RD ## [1] 0.34 OR &lt;- (p1/(1-p1))/(p0/(1-p0)) OR ## [1] 4.512397 1.4 Further reading Useful references VanderWeele (2009), VanderWeele and Knol (2011), K. J. Rothman (2012), VanderWeele and Knol (2014), Bours (2021), Whitcomb and Naimi (2023) Reference "],["interaction-1.html", "Chapter 2 Interaction 2.1 Modelling to obtain OR 2.2 Modelling to obtain RR 2.3 Modelling to obtain RD 2.4 Reporting guidelines", " Chapter 2 Interaction We will be using three measures of effect to explain the concept and necessary implementation ideas 2.1 Modelling to obtain OR odds ratio (OR), Multiplicative scale Logit[Pr(Y=1)] = \\(\\alpha_0\\) + \\(\\alpha_A\\) A + \\(\\alpha_B\\) B + \\(\\alpha_{AB}\\) (A \\(\\times\\) B) Condition for presence of interaction (“departure from multiplicativity”) OR10 \\(\\times\\) OR01 \\(\\ne\\) OR11 \\(\\exp(\\alpha_A)\\) \\(\\times\\) \\(\\exp(\\alpha_B)\\) \\(\\ne\\) \\(\\exp(\\alpha_A+ \\alpha_B + \\alpha_{AB})\\) synergism / super-multiplicative OR11 &gt; OR10 \\(\\times\\) OR01 antagonism / sub-multiplicative OR11 &lt; OR10 \\(\\times\\) OR01 Note: The above assumes that both exposures are risk factors for the outcome (OR &gt; 1), not protective factors. If protective, estimates of RERI and AP (defined later) will be invalid, although the estimate of SI is not affected by this condition. 2.1.1 Base 2.1.1.1 no alcohol, no smoking for OR(smk1 on outcome [alc1==0] and OR(alc1 on outcome [smk1==0] Model-based SE estimates from logistic regression model (Naimi and Whitcomb 2020): require(interactionR) data(OCdata) Obs.Data &lt;- OCdata Obs.Data$smk &lt;- as.factor(Obs.Data$smk) Obs.Data$smk &lt;- relevel(Obs.Data$smk, ref = &quot;0&quot;) Obs.Data$alc &lt;- as.factor(Obs.Data$alc) Obs.Data$alc &lt;- relevel(Obs.Data$alc, ref = &quot;0&quot;) fit.or.int11 &lt;- glm(oc ~ alc + smk + alc:smk, family = binomial(link = &#39;logit&#39;), data = Obs.Data) require(jtools) results.or.model11 &lt;- summ(fit.or.int11, model.info = FALSE, model.fit = FALSE, exp = TRUE, confint = TRUE) results.or.model11 exp(Est.) 2.5% 97.5% z val. p (Intercept) 0.15 0.04 0.50 -3.06 0.00 alc1 3.33 0.70 15.86 1.51 0.13 smk1 2.96 0.68 12.91 1.45 0.15 alc1:smk1 0.91 0.15 5.42 -0.10 0.92 Standard errors: MLE 2.1.2 Estimates of different ORs 2.1.2.0.1 Alcohol ## OR00 = 1 OR10 &lt;- exp(sum(summary(fit.or.int11)$coef[c(&#39;alc1&#39;),&#39;Estimate&#39;])) OR10 ## OR_A=1 ## [1] 3.333333 \\(\\alpha_A\\) = 1.2 OR_{A=1} = OR10 = \\(\\exp(\\alpha_A)\\) = 3.33 2.1.2.0.2 Smoking OR01 &lt;- exp(sum(summary(fit.or.int11)$coef[c(&#39;smk1&#39;),&#39;Estimate&#39;])) OR01 ## OR_B=1 ## [1] 2.962963 \\(\\alpha_B\\) = 1.09 OR_{B=1} = OR01 = \\(\\exp(\\alpha_B)\\) = 2.96 2.1.2.0.3 Both alcohol and smoking OR11 &lt;- exp(sum(summary(fit.or.int11)$coef[c(&#39;alc1&#39;,&#39;smk1&#39;,&#39;alc1:smk1&#39;),&#39;Estimate&#39;])) OR11 ##OR_A=1,B=1 ## [1] 9.036145 \\(\\alpha_{AB}\\) = -0.09 OR_{A=1,B=1} = OR11 = 9.04 2.1.2.0.4 Joint effect? Is OR11 \\(\\ne\\) OR10 * OR01 OR10 * OR01 ## [1] 9.876543 2.1.2.0.5 Additive scales Relative excess risk due to interaction (RERI) ranges from 0 to \\(\\infty\\) 0 means no interaction +ve means positive interaction Proportion of outcome among those with both exposures that is attributable to the interaction (AP) ranges from -1 to 1 0 means no interaction Synergy index (SI) ratio of the combined effects and the individual effects ranges from 0 to \\(\\infty\\) greater than 1 means positive interaction RERI &lt;- OR11 - OR10 - OR01 + 1 RERI ## [1] 3.739848 AP &lt;- RERI / OR11 AP ## [1] 0.4138765 SI &lt;- (OR11 - 1)/ (OR10 - 1 + OR01 - 1) SI ## [1] 1.870482 2.1.2.0.6 Recoding to obtain different combinations 2.1.2.0.6.1 Base: alcohol drinker, no smoking for OR(smk1 on outcome [alc1==1] Obs.Data &lt;- OCdata Obs.Data$smk &lt;- as.factor(Obs.Data$smk) Obs.Data$smk &lt;- relevel(Obs.Data$smk, ref = &quot;0&quot;) Obs.Data$alc &lt;- as.factor(Obs.Data$alc) Obs.Data$alc &lt;- relevel(Obs.Data$alc, ref = &quot;1&quot;) fit.or.int01 &lt;- glm(oc ~ alc + smk + alc:smk, family = binomial(link = &#39;logit&#39;), data = Obs.Data) results.or.model01 &lt;- summ(fit.or.int01, model.info = FALSE, model.fit = FALSE, exp = TRUE, confint = TRUE) results.or.model01 exp(Est.) 2.5% 97.5% z val. p (Intercept) 0.50 0.19 1.33 -1.39 0.17 alc0 0.30 0.06 1.43 -1.51 0.13 smk1 2.71 1.00 7.37 1.95 0.05 alc0:smk1 1.09 0.18 6.48 0.10 0.92 Standard errors: MLE 2.1.2.0.6.2 Base: Smoker, no alcohol for OR(alc1 on outcome [smk1==1] Obs.Data &lt;- OCdata Obs.Data$smk &lt;- as.factor(Obs.Data$smk) Obs.Data$smk &lt;- relevel(Obs.Data$smk, ref = &quot;1&quot;) Obs.Data$alc &lt;- as.factor(Obs.Data$alc) Obs.Data$alc &lt;- relevel(Obs.Data$alc, ref = &quot;0&quot;) fit.or.int10 &lt;- glm(oc ~ alc + smk + alc:smk, family = binomial(link = &#39;logit&#39;), data = Obs.Data) results.or.model10 &lt;- summ(fit.or.int10, model.info = FALSE, model.fit = FALSE, exp = TRUE, confint = TRUE) results.or.model10 exp(Est.) 2.5% 97.5% z val. p (Intercept) 0.44 0.19 1.02 -1.91 0.06 alc1 3.05 1.29 7.18 2.55 0.01 smk0 0.34 0.08 1.47 -1.45 0.15 alc1:smk0 1.09 0.18 6.48 0.10 0.92 Standard errors: MLE OR10b &lt;- exp(sum(summary(fit.or.int10)$coef[c(&#39;alc1&#39;),&#39;Estimate&#39;])) OR10b ## [1] 3.049699 2.1.2.1 Multiplicative scale Multiplicative.scale &lt;- exp(sum(summary(fit.or.int11)$coef[c(&#39;alc1:smk1&#39;),&#39;Estimate&#39;])) Multiplicative.scale ## [1] 0.9149096 Multiplicative.scale = \\(\\exp(\\alpha_{AB})\\) = 0.91 # estimates of alcohol after changing smoking ref levels OR10b / OR10 ## [1] 0.9149096 2.1.3 Reporting guideline Ref: Knol and VanderWeele (2012), Alli (2021) int.object &lt;- interactionR(fit.or.int11, exposure_names = c(&quot;alc1&quot;, &quot;smk1&quot;), ci.type = &quot;mover&quot;, ci.level = 0.95, em=FALSE, recode = FALSE) kable(int.object$dframe[,1:4], digits = 2) Measures Estimates CI.ll CI.ul OR00 1.00 NA NA OR01 2.96 0.68 12.91 OR10 3.33 0.70 15.86 OR11 9.04 2.64 30.91 OR(smk1 on outcome [alc1==0] 2.96 0.68 12.91 OR(smk1 on outcome [alc1==1] 2.71 1.00 7.37 OR(alc1 on outcome [smk1==0] 3.33 0.70 15.86 OR(alc1 on outcome [smk1==1] 3.05 1.29 7.18 Multiplicative scale 0.91 0.15 5.42 RERI 3.74 -11.43 21.87 AP 0.41 -0.38 0.81 SI 1.87 0.65 5.42 2.1.4 Other available functions Ref: Mathur and VanderWeele (2018) ## Mathur MB &amp; VanderWeele TJ (2018) source(&quot;Additive interactions function.R&quot;) additive_interactions(fit.or.int11) ## Loading required package: msm ## Stat Est CI.lo CI.hi p.val.0 p.val.epi ## 1 RERI 3.7398483 -1.83667500 9.3163716 0.09435021 0.2704345 ## 2 AP 0.4138765 -0.07306308 0.9008162 0.04786863 NA ## 3 alc1 0.2903548 -0.13508981 0.7157995 0.09050950 NA ## 4 smk1 0.2442668 -0.08791751 0.5764510 0.07475981 NA ## 5 alc1:smk1 0.4653784 -0.10296969 1.0337265 0.05426119 NA ## p.val.suff.cause ## 1 0.1677822 ## 2 NA ## 3 NA ## 4 NA ## 5 NA 2.1.5 Interaction definitions for OR Summary of interaction definition for OR. Groups and Conditions Risk Odds Ratio Baseline (exposed to none) \\(R_{A = 0, B = 0} = P[Y^{a=0, b=0} | L]\\) Reference Exposed to \\(A\\) only \\(R_{A = 1, B = 0} = P[Y^{a=1, b=0} | L]\\) \\(OR_{A = 1} = [R_{A = 1, B = 0} / (1-R_{A = 1, B = 0})] / [R_{A = 0, B = 0} / (1 - R_{A = 0, B = 0})]\\) Exposed to \\(B\\) only \\(R_{A = 0, B = 1} = P[Y^{a=0, b=1} | L]\\) \\(OR_{B = 1} = [R_{A = 0, B = 1} / (1-R_{A = 0, B = 1})] / [R_{A = 0, B = 0} / (1 - R_{A = 0, B = 0})]\\) Exposed to both \\(A\\) and \\(B\\) \\(R_{A = 1, B = 1} = P[Y^{a=1, b=1} | L]\\) \\(OR_{A = 1, B = 1} = [R_{A = 1, B = 1} / (1-R_{A = 1, B = 1})] / [R_{A = 0, B = 0} / (1 - R_{A = 0, B = 0})]\\) Condition for interaction \\(OR_{A = 1, B = 1} \\ne OR_{A = 1} \\times OR_{B = 1}\\) Synergism \\(OR_{A = 1, B = 1} &gt; OR_{A = 1} \\times OR_{B = 1}\\) Antagonism \\(OR_{A = 1, B = 1} &lt; OR_{A = 1} \\times OR_{B = 1}\\) 2.2 Modelling to obtain RR risk ratio (RR), Multiplicative scale Very similar ideas as in OR Obs.Data &lt;- OCdata Obs.Data$smk &lt;- as.factor(Obs.Data$smk) Obs.Data$smk &lt;- relevel(Obs.Data$smk, ref = &quot;0&quot;) Obs.Data$alc &lt;- as.factor(Obs.Data$alc) Obs.Data$alc &lt;- relevel(Obs.Data$alc, ref = &quot;0&quot;) fit.rr.int11 &lt;- glm(oc ~ alc + smk + alc:smk, family = poisson(link = &#39;log&#39;), data = Obs.Data) results.rr.model11 &lt;- summ(fit.rr.int11, model.info = FALSE, model.fit = FALSE, exp = TRUE, robust = &quot;HC1&quot;, confint = TRUE) results.rr.model11 exp(Est.) 2.5% 97.5% z val. p (Intercept) 0.13 0.04 0.40 -3.53 0.00 alc1 2.56 0.64 10.22 1.33 0.18 smk1 2.36 0.63 8.89 1.27 0.20 alc1:smk1 0.73 0.15 3.46 -0.39 0.69 Standard errors: Robust, type = HC1 Ref: Naimi and Whitcomb (2020) Alternate formulation using log-binomial is possible (using model based SE, but confidence intervals somewhat differ from those reported from poisson(log)): fit.rr.int11lb &lt;- glm(oc ~ alc + smk + alc:smk, family = binomial(link = &#39;log&#39;), data = Obs.Data) results.rr.model11lb &lt;- summ(fit.rr.int11lb, model.info = FALSE, model.fit = FALSE, exp = TRUE, confint = TRUE) results.rr.model11lb exp(Est.) 2.5% 97.5% z val. p (Intercept) 0.13 0.05 0.37 -3.78 0.00 alc1 2.56 0.74 8.84 1.48 0.14 smk1 2.36 0.71 7.85 1.40 0.16 alc1:smk1 0.73 0.19 2.88 -0.45 0.66 Standard errors: MLE 2.2.1 Estimates of different RRs 2.2.1.1 Alcohol ## RR00 = 1 RR10 &lt;- exp(sum(summary(fit.rr.int11)$coef[c(&#39;alc1&#39;),&#39;Estimate&#39;])) RR10 ## RR_A=1 ## [1] 2.555555 \\(\\alpha_A\\) = 0.94 RR_{A=1} = RR10 = \\(\\exp(\\alpha_A)\\) = 2.56 2.2.1.2 Smoking RR01 &lt;- exp(sum(summary(fit.rr.int11)$coef[c(&#39;smk1&#39;),&#39;Estimate&#39;])) RR01 ## RR_B=1 ## [1] 2.358974 \\(\\alpha_B\\) = 0.86 RR_{B=1} = RR01 = \\(\\exp(\\alpha_B)\\) = 2.36 2.2.1.3 Both alcohol and smoking RR11 &lt;- exp(sum(summary(fit.rr.int11)$coef[c(&#39;alc1&#39;,&#39;smk1&#39;,&#39;alc1:smk1&#39;),&#39;Estimate&#39;])) RR11 ##RR_A=1,B=1 ## [1] 4.411764 \\(\\alpha_{AB}\\) = -0.31 RR_{A=1,B=1} = RR11 = 4.41 2.2.1.4 Joint effect? Is RR11 \\(\\ne\\) RR10 * RR01 RR10 * RR01 ## [1] 6.028489 2.2.1.5 Multiplicative scale Multiplicative.scale &lt;- exp(sum(summary(fit.rr.int11)$coef[c(&#39;alc1:smk1&#39;),&#39;Estimate&#39;])) Multiplicative.scale ## [1] 0.7318192 Multiplicative.scale = \\(\\exp(\\alpha_{AB})\\) = 0.73 2.2.1.6 Additive scales RERI &lt;- RR11 - RR10 - RR01 + 1 RERI ## [1] 0.4972348 AP &lt;- RERI / RR11 AP ## [1] 0.1127066 SI &lt;- (RR11 - 1)/ (RR10 - 1 + RR01 - 1) SI ## [1] 1.170606 2.2.1.7 Reporting guideline int.object &lt;- interactionR(fit.rr.int11, exposure_names = c(&quot;alc1&quot;, &quot;smk1&quot;), ci.type = &quot;mover&quot;, ci.level = 0.95, em=FALSE, recode = FALSE) kable(int.object$dframe[,1:4], digits = 2) Measures Estimates CI.ll CI.ul OR00 1.00 NA NA OR01 2.36 0.63 8.89 OR10 2.56 0.64 10.22 OR11 4.41 1.41 13.78 OR(smk1 on outcome [alc1==0] 2.36 0.63 8.89 OR(smk1 on outcome [alc1==1] 1.73 0.77 3.88 OR(alc1 on outcome [smk1==0] 2.56 0.64 10.22 OR(alc1 on outcome [smk1==1] 1.87 0.92 3.79 Multiplicative scale 0.73 0.15 3.46 RERI 0.50 -9.97 7.01 AP 0.11 -0.82 0.75 SI 1.17 0.42 3.23 Ref: Alli (2021) 2.2.1.8 Interaction definitions for RR Summary of interaction definition for RR. Groups and Conditions Risk Risk Ratio Baseline (exposed to none) \\(R_{A = 0, B = 0} = P[Y^{a=0, b=0} | L]\\) Reference Exposed to \\(A\\) only \\(R_{A = 1, B = 0} = P[Y^{a=1, b=0} | L]\\) \\(RR_{A = 1} = R_{A = 1, B = 0} / R_{A = 0, B = 0}\\) Exposed to \\(B\\) only \\(R_{A = 0, B = 1} = P[Y^{a=0, b=1} | L]\\) \\(RR_{B = 1} = R_{A = 0, B = 1} / R_{A = 0, B = 0}\\) Exposed to both \\(A\\) and \\(B\\) \\(R_{A = 1, B = 1} = P[Y^{a=1, b=1} | L]\\) \\(RR_{A = 1, B = 1} = R_{A = 1, B = 1} / R_{A = 0, B = 0}\\) Condition for interaction \\(RR_{A = 1, B = 1} \\ne RR_{A = 1} \\times RR_{B = 1}\\) Synergism \\(RR_{A = 1, B = 1} &gt; RR_{A = 1} \\times RR_{B = 1}\\) Antagonism \\(RR_{A = 1, B = 1} &lt; RR_{A = 1} \\times RR_{B = 1}\\) 2.3 Modelling to obtain RD risk difference (RD), Additive scale risk(Y) = \\(\\alpha_0\\) + \\(\\alpha_A\\) A + \\(\\alpha_B\\) B + \\(\\alpha_{AB}\\) (A \\(\\times\\) B) RD10 \\(\\times\\) RD01 \\(\\ne\\) RD11 \\(\\alpha_A\\) + \\(\\alpha_B\\) \\(\\ne\\) (\\(\\alpha_A\\) + \\(\\alpha_B\\) + \\(\\alpha_{AB}\\)) synergism / super-additive RD11 &gt; RD10 + RD01 antagonism / sub-additive RD11 &lt; RD10 + RD01 Obs.Data &lt;- OCdata Obs.Data$smk &lt;- as.factor(Obs.Data$smk) Obs.Data$smk &lt;- relevel(Obs.Data$smk, ref = &quot;0&quot;) Obs.Data$alc &lt;- as.factor(Obs.Data$alc) Obs.Data$alc &lt;- relevel(Obs.Data$alc, ref = &quot;0&quot;) fit.rd.int11 &lt;- glm(oc ~ alc + smk + alc:smk, family = gaussian(link = &#39;identity&#39;), data = Obs.Data) results.rd.model11 &lt;- summ(fit.rd.int11, model.info = FALSE, model.fit = FALSE, exp = FALSE, robust = &quot;HC1&quot;, confint = TRUE) results.rd.model11 Est. 2.5% 97.5% t val. p (Intercept) 0.13 -0.07 0.33 1.28 0.20 alc1 0.20 -0.10 0.50 1.32 0.19 smk1 0.18 -0.10 0.45 1.27 0.20 alc1:smk1 0.06 -0.29 0.42 0.36 0.72 Standard errors: Robust, type = HC1 Ref: Naimi and Whitcomb (2020) Alternate formulation using binomial(identity) is possible (using model based SE, but confidence intervals slightly differ from those reported from gaussian(identity)): fit.rd.int11bi &lt;- glm(oc ~ alc + smk + alc:smk, family = binomial(link = &#39;identity&#39;), data = Obs.Data) results.rd.model11bi &lt;- summ(fit.rd.int11bi, model.info = FALSE, model.fit = FALSE, exp = FALSE, confint = TRUE) results.rd.model11bi Est. 2.5% 97.5% z val. p (Intercept) 0.13 -0.01 0.27 1.86 0.06 alc1 0.20 -0.05 0.46 1.54 0.12 smk1 0.18 -0.05 0.40 1.55 0.12 alc1:smk1 0.06 -0.25 0.38 0.40 0.69 Standard errors: MLE 2.3.1 Base: Smoker, no alcohol for RD(alc1 on outcome [smk1==1] Alternate combination of smoking: Obs.Data &lt;- OCdata Obs.Data$smk &lt;- as.factor(Obs.Data$smk) Obs.Data$smk &lt;- relevel(Obs.Data$smk, ref = &quot;1&quot;) Obs.Data$alc &lt;- as.factor(Obs.Data$alc) Obs.Data$alc &lt;- relevel(Obs.Data$alc, ref = &quot;0&quot;) fit.rd.int01 &lt;- glm(oc ~ alc + smk + alc:smk, family = gaussian(link = &#39;identity&#39;), data = Obs.Data) results.rd.model01 &lt;- summ(fit.rd.int01, model.info = FALSE, model.fit = FALSE, exp = FALSE, robust = &quot;HC1&quot;, confint = TRUE) results.rd.model01 Est. 2.5% 97.5% t val. p (Intercept) 0.31 0.12 0.49 3.22 0.00 alc1 0.27 0.07 0.46 2.71 0.01 smk0 -0.18 -0.45 0.10 -1.27 0.20 alc1:smk0 -0.06 -0.42 0.29 -0.36 0.72 Standard errors: Robust, type = HC1 2.3.2 Estimates of different RDs 2.3.2.1 Alcohol ## RD00 = 0 RD10 &lt;- sum(summary(fit.rd.int11)$coef[c(&#39;alc1&#39;),&#39;Estimate&#39;]) RD10 ## RD_A=1 ## [1] 0.2028986 RD_{A=1} = RD10 = \\(\\alpha_A\\) = 0.2 From alternate combination of smoking RD10b &lt;- sum(summary(fit.rd.int01)$coef[c(&#39;alc1&#39;),&#39;Estimate&#39;]) RD10b ## RD_A=1 ## [1] 0.2677553 2.3.2.2 Smoking RD01 &lt;- sum(summary(fit.rd.int11)$coef[c(&#39;smk1&#39;),&#39;Estimate&#39;]) RD01 ## RD_B=1 ## [1] 0.1772575 RD_{B=1} = RD01 = \\(\\alpha_B\\) = 0.18 2.3.2.3 Both alcohol and smoking RD11 &lt;- sum(summary(fit.rd.int11)$coef[c(&#39;alc1&#39;,&#39;smk1&#39;,&#39;alc1:smk1&#39;),&#39;Estimate&#39;]) RD11 ##RD_A=1,B=1 ## [1] 0.4450128 RD_{A=1,B=1} = RD11 = \\(\\alpha_{AB}\\) = 0.06 2.3.2.4 Joint effect? Is RD11 \\(\\ne\\) RD10 + RD01 RD10 + RD01 ## [1] 0.3801561 2.3.2.5 Additive scale (interaction contrast) IC &lt;- RD10b - RD10 IC ## [1] 0.06485671 Current version of interactionR do not support RD, although the documentation says so: Alli (2021) 2.3.3 Interaction definitions for RD Summary of interaction definition for RD. Groups and Conditions Risk Risk Difference Baseline (exposed to none) \\(R_{A = 0, B = 0} = P[Y^{a=0, b=0} | L]\\) Reference Exposed to \\(A\\) only \\(R_{A = 1, B = 0} = P[Y^{a=1, b=0} | L]\\) \\(RD_{A = 1} = R_{A = 1, B = 0} - R_{A = 0, B = 0}\\) Exposed to \\(B\\) only \\(R_{A = 0, B = 1} = P[Y^{a=0, b=1} | L]\\) \\(RD_{B = 1} = R_{A = 0, B = 1} - R_{A = 0, B = 0}\\) Exposed to both \\(A\\) and \\(B\\) \\(R_{A = 1, B = 1} = P[Y^{a=1, b=1} | L]\\) \\(RD_{A = 1, B = 1} = R_{A = 1, B = 1} - R_{A = 0, B = 0}\\) Condition for interaction \\(RD_{A = 1, B = 1} \\ne RD_{A = 1} + RD_{B = 1}\\) Synergism \\(RD_{A = 1, B = 1} &gt; RD_{A = 1} + RD_{B = 1}\\) Antagonism \\(RD_{A = 1, B = 1} &lt; RD_{A = 1} + RD_{B = 1}\\) 2.4 Reporting guidelines How to determine whether interaction should be reported in additive or multiplicative scale? Not via empirical assessment (analysis of data at hand) Study objectives should be clear data generating mechanism should be considered carefully What if results differ? Very possible to have additive interaction present, but not at a multiplicative scale and vice versa When conclusions differ (interaction is present in additive, but absent in multiplicative or vice versa), both should be reported. When both are concluding the same (interaction is present in both scales or absent), questions related to magnitude remains Reference "],["effect-modification-1.html", "Chapter 3 Effect modification 3.1 Estimates from Tabulation 3.2 Estimates from Regression", " Chapter 3 Effect modification Multiplicative odds ratio scale are very popular for examining effect modification. However, often multiplicative scale is not helpful for public health related interpretations, and is considered as inadequate for such assessment. Additive probability scale should be additionally used for such assessment. We will discuss the assessment of effect modification using one example data, and show how we can calculate the measures using R or calculate them by hand. 3.1 Estimates from Tabulation require(interactionR) data(OCdata) outcome = &quot;oc&quot; ex = &quot;alc&quot; dataset = OCdata Now we will be working with stratified data (stratification by levels of effect modifier) 3.1.1 First strata: Smoking = 1 str = &quot;smk&quot; str.lab = 1 dataset1 &lt;- dataset[dataset[[str]] == str.lab,] M &lt;- table(dataset1[[ex]], dataset1[[outcome]]) M3 &lt;- matrix(c(M[2,2],M[2,1],M[1,2],M[1,1]), nrow = 2, byrow = TRUE) res1 &lt;- epi.2by2(dat = M3, method = &quot;cross.sectional&quot;, conf.level = 0.95, units = 1, interpret = FALSE, outcome = &quot;as.columns&quot;) res1 ## Outcome + Outcome - Total Prevalence * ## Exposed + 225 166 391 0.58 (0.52 to 0.62) ## Exposed - 8 18 26 0.31 (0.14 to 0.52) ## Total 233 184 417 0.56 (0.51 to 0.61) ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Prevalence ratio 1.87 (1.04, 3.35) ## Odds ratio 3.05 (1.29, 7.18) ## Attrib prevalence in the exposed * 0.27 (0.08, 0.45) ## Attrib fraction in the exposed (%) 46.53 (4.23, 70.15) ## Attrib prevalence in the population * 0.25 (0.07, 0.43) ## Attrib fraction in the population (%) 44.93 (3.31, 68.64) ## ------------------------------------------------------------------- ## Uncorrected chi2 test that OR = 1: chi2(1) = 7.089 Pr&gt;chi2 = 0.008 ## Fisher exact test that OR = 1: Pr&gt;chi2 = 0.013 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per population unit Check the results yourself p1.s1 &lt;- as.numeric(strsplit(as.character(res1$tab$` Prevalence *`), &quot; &quot;)[[1]][1]) p0.s1 &lt;- as.numeric(strsplit(as.character(res1$tab$` Prevalence *`), &quot; &quot;)[[2]][1]) RR.s1 &lt;- p1.s1/p0.s1 RR.s1 ## [1] 1.870968 RD.s1 &lt;- p1.s1 - p0.s1 RD.s1 ## [1] 0.27 OR.s1a &lt;- (p1.s1/(1-p1.s1)) OR.s1b &lt;- (p0.s1/(1-p0.s1)) OR.s1 &lt;- OR.s1a/OR.s1b OR.s1 ## [1] 3.073733 3.1.2 second strata: : Smoking = 0 str.lab = 0 dataset1 &lt;- dataset[dataset[[str]] == str.lab,] M &lt;- table(dataset1[[ex]], dataset1[[outcome]]) M3 &lt;- matrix(c(M[2,2],M[2,1],M[1,2],M[1,1]), nrow = 2, byrow = TRUE) res0 &lt;- epi.2by2(dat = M3, method = &quot;cross.sectional&quot;, conf.level = 0.95, units = 1, interpret = FALSE, outcome = &quot;as.columns&quot;) res0 ## Outcome + Outcome - Total Prevalence * ## Exposed + 6 12 18 0.33 (0.13 to 0.59) ## Exposed - 3 20 23 0.13 (0.03 to 0.34) ## Total 9 32 41 0.22 (0.11 to 0.38) ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Prevalence ratio 2.56 (0.74, 8.84) ## Odds ratio 3.33 (0.70, 15.86) ## Attrib prevalence in the exposed * 0.20 (-0.05, 0.46) ## Attrib fraction in the exposed (%) 60.87 (-35.37, 88.69) ## Attrib prevalence in the population * 0.09 (-0.10, 0.28) ## Attrib fraction in the population (%) 40.58 (-37.53, 74.33) ## ------------------------------------------------------------------- ## Yates corrected chi2 test that OR = 1: chi2(1) = 1.387 Pr&gt;chi2 = 0.239 ## Fisher exact test that OR = 1: Pr&gt;chi2 = 0.147 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per population unit Check the results yourself p1.s0 &lt;- as.numeric(strsplit(as.character(res0$tab$` Prevalence *`), &quot; &quot;)[[1]][1]) p0.s0 &lt;- as.numeric(strsplit(as.character(res0$tab$` Prevalence *`), &quot; &quot;)[[2]][1]) RR.s0 &lt;- p1.s0/p0.s0 RR.s0 ## [1] 2.538462 RD.s0 &lt;- p1.s0 - p0.s0 RD.s0 ## [1] 0.2 OR.s0a &lt;- (p1.s0/(1-p1.s0)) OR.s0b &lt;- (p0.s0/(1-p0.s0)) OR.s0 &lt;- OR.s0a/OR.s0b OR.s0 ## [1] 3.296211 3.1.3 Does effect modification exist? OR: 3.0737327 vs. 3.2962113 Ratio of the OR in two groups (null value = 1) OR.s1 / OR.s0 ## [1] 0.9325048 RD: 0.27 vs. 0.2 Difference of the RD in two groups (null value = 0). This is also known as interaction contrast (IC) RD.s1 - RD.s0 ## [1] 0.07 RR: 1.8709677 vs. 2.5384615 Ratio of the RR in two groups (null value = 1) RR.s1 / RR.s0 ## [1] 0.7370479 Are they equivalent in both stratified groups? 3.1.3.1 Are the lines parallel? We can utilize the probability and log-odds calculated before to plot these lines: par(mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE) plot(c(1,0),c(p1.s1,p0.s1), ylim = range(c(p1.s1,p1.s0, p0.s1,p0.s0)), xlim=c(0,1), xlab = &quot;exposure&quot;, ylab = &quot;Probability of outcome&quot;, lty = 1, col = &quot;green&quot;, type = &quot;l&quot;, main = &quot;Probability scale&quot;) lines(c(1,0),c(p1.s0,p0.s0), lty = 2, col = &quot;red&quot;) legend(&quot;bottomright&quot;, inset=c(-0.2,0), legend=c(&quot;strata 1&quot;,&quot;strata 0&quot;), pch=c(1,3), title=&quot;effect modifier&quot;, col = c(&quot;green&quot;, &quot;red&quot;)) par(mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE) plot(c(1,0),c(log(OR.s1a), log(OR.s1b)), ylim = range(c(log(OR.s1a), log(OR.s0a),log(OR.s1b),log(OR.s0b))), xlim=c(0,1), xlab = &quot;exposure&quot;, ylab = &quot;log-odds of outcome&quot;, lty = 1, col = &quot;green&quot;, type = &quot;l&quot;, main = &quot;Log-odds scale&quot;) lines(c(1,0),c(log(OR.s0a),log(OR.s0b)), lty = 2, col = &quot;red&quot;) legend(&quot;bottomright&quot;, inset=c(-0.2,0), legend=c(&quot;strata 1&quot;,&quot;strata 0&quot;), pch=c(1,3), title=&quot;effect modifier&quot;, col = c(&quot;green&quot;, &quot;red&quot;)) 3.2 Estimates from Regression Add interaction term in the regression check the coef of the interaction terms, and compare that number with the numbers calculated at the previous section (rations and differences): they should be equivalent if not equal Using regression could help accommodate the following covariates could be added exposure variable could be continuous covariate 3.2.1 OR: multiplicative scale OCdata$alc &lt;- as.factor(OCdata$alc) OCdata$smk &lt;- as.factor(OCdata$smk) reg1 = glm(oc~alc*smk, family = binomial(link = &#39;logit&#39;), data = OCdata) require(jtools) reg.res1 &lt;- summ(reg1, exp = TRUE) reg.res1$coeftable ## exp(Est.) 2.5% 97.5% z val. p ## (Intercept) 0.1500000 0.04457383 0.5047805 -3.06413033 0.002183038 ## alc1 3.3333333 0.70060657 15.8592734 1.51286779 0.130313246 ## smk1 2.9629630 0.68004588 12.9096430 1.44647020 0.148045366 ## alc1:smk1 0.9149096 0.15436110 5.4227369 -0.09794692 0.921974441 P-values are used to determine significance of the interaction term. Let us estimate the ORs by effect modifier require(Publish) saveres &lt;- publish(reg1) ## Variable Units OddsRatio CI.95 p-value ## alc(0): smk(1 vs 0) 2.96 [0.68;12.91] 0.14805 ## alc(1): smk(1 vs 0) 2.71 [1.00;7.37] 0.05070 ## smk(0): alc(1 vs 0) 3.33 [0.70;15.86] 0.13031 ## smk(1): alc(1 vs 0) 3.05 [1.29;7.18] 0.01073 We can also plot this to check the overlap of CIs visually plot(c(0,1), saveres$rawTable[3:4,&quot;OddsRatio&quot;], xlab=&quot;effect modifier&quot;, ylab=&quot;OR&quot;, main=&quot;OR by effect modifier&quot;, xlim = c(0,1), ylim = range(saveres$rawTable[3:4,4:5])) lines(c(0,0), saveres$rawTable[3,c(&quot;Lower&quot;,&quot;Upper&quot;)], col=&quot;blue&quot;, lty=2) lines(c(1,1), saveres$rawTable[4,c(&quot;Lower&quot;,&quot;Upper&quot;)], col=&quot;blue&quot;, lty=2) 3.2.2 Converted estimates from OR require(interactionR) reg1 = glm(oc~alc*smk, family = binomial(link = &#39;logit&#39;), data = OCdata) table_object = interactionR(reg1, exposure_names = c(&quot;smk1&quot;, &quot;alc1&quot;), ci.type = &quot;mover&quot;, ci.level = 0.95, em=TRUE, recode = FALSE) table_object$dframe ## Measures Estimates CI.ll CI.ul p ## 1 OR00 1.0000000 NA NA NA ## 2 OR01 3.3333333 0.7006066 15.859273 0.130313246 ## 3 OR10 2.9629630 0.6800459 12.909643 0.148045366 ## 4 OR11 9.0361446 2.6413389 30.913075 0.000483904 ## 5 OR(alc1 on outcome [smk1==0] 3.3333333 0.7006066 15.859273 0.130313246 ## 6 OR(alc1 on outcome [smk1==1] 3.0496988 1.2948765 7.182664 0.010707090 ## 7 Multiplicative scale 0.9149096 0.1543611 5.422737 0.921974441 ## 8 RERI 3.7398483 -11.4297248 21.872158 NA interactionR_table(table_object) ## Do you want to save a Microsoft Word copy of the em/interaction table to your working directory? (yes/No/cancel) ## a flextable object. ## col_keys: `*`, `alc1 absent`, `alc1 present`, `Effect of alc1 within the strata of smk1` ## header has 1 row(s) ## body has 6 row(s) ## original dataset sample: ## * alc1 absent alc1 present ## 1 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; ## 2 &lt;NA&gt; OR [95% CI] OR [95% CI] ## 3 smk1 absent 1 [Reference] 3.33 [0.7, 15.86] ## 4 smk1 present 2.96 [0.68, 12.91] 9.04 [2.64, 30.91] ## 5 Multiplicative scale 0.91 [0.15, 5.42] &lt;NA&gt; ## Effect of alc1 within the strata of smk1 ## 1 &lt;NA&gt; ## 2 OR [95% CI] ## 3 3.33 [0.7, 15.86] ## 4 3.05 [1.29, 7.18] ## 5 &lt;NA&gt; Compare with previously obtained results, and also calculate by hand beta1 &lt;- as.numeric(reg1$coefficients[2]) OR10 &lt;- exp(beta1) OR10 ## [1] 3.333333 beta2 &lt;- as.numeric(reg1$coefficients[3]) OR01 &lt;- exp(beta2) OR01 ## [1] 2.962963 beta3 &lt;- as.numeric(reg1$coefficients[4]) OR11 &lt;- exp(beta1 + beta2 + beta3) OR11 ## [1] 9.036145 RERI &lt;- OR11 - OR10 - OR01 + 1 RERI ## [1] 3.739848 3.2.3 RR and RD Estimation approach is same as interaction (adding an interaction term in the corresponding regression), we are just interested in estimates from each level of the effect modifier (hence less estimates are needed compared to those estimated in interaction assessment). "],["reference.html", "Reference", " Reference "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
